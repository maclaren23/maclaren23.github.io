"use strict";function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){i=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(i)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mySlider(){var e=document.querySelectorAll(".slider__item"),r=document.querySelector(".slider__wrapper"),n=document.querySelector(".slider__inner"),t=document.querySelector(".slider__btn_prev"),a=document.querySelector(".slider__btn_next"),s=parseInt(getComputedStyle(r).width,10),i=document.querySelector(".slider__bullets"),o=1,l=0,d=[];function c(){var t=parseInt(getComputedStyle(r).width,10);e.forEach(function(e){e.style.width=t+"px"}),n.style.width=parseInt(e[0].style.width)*e.length+"px"}c();for(var u=0;u<e.length;u++){var m=document.createElement("div");m.classList.add("slider__dot"),m.setAttribute("data-slide",u+1),0==u&&m.classList.add("slider__dot_active"),i.insertAdjacentElement("beforeend",m),d.push(m)}function v(){d.forEach(function(e){return e.classList.remove("slider__dot_active")}),d[o-1].classList.add("slider__dot_active")}a.addEventListener("click",function(){l==s*(e.length-1)?l=0:l+=s,n.style.transform="translateX(-".concat(l,"px)"),o==e.length?o=1:o++,v()}),t.addEventListener("click",function(){0==l?l=s*(e.length-1):l-=s,n.style.transform="translateX(-".concat(l,"px)"),1==o?o=e.length:o--,v()}),d.forEach(function(e){e.addEventListener("click",function(e){e=e.target.getAttribute("data-slide");l=s*((o=e)-1),n.style.transform="translateX(-".concat(l,"px)"),v()})}),window.addEventListener("resize",function(){c(),n.style.transform="translateX(-".concat(parseInt(e[0].style.width),"px)")})}function activateSlider(){new Swiper(".swiper",{navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},loop:!0,slidesPerView:1})}function showModal(){var t=document.querySelector(".modal-signin"),r=document.querySelector(".modal-reg"),n=document.querySelector(".modal-sendmsg");document.addEventListener("click",function(e){e=e.target;e.preventDefault,e.hasAttribute("data-signin")&&t.classList.add("modal-view"),e.hasAttribute("data-register")&&r.classList.add("modal-view"),e.hasAttribute("data-sendMsg")&&n.classList.add("modal-view"),e.hasAttribute("data-close")&&(t.classList.remove("modal-view"),r.classList.remove("modal-view"),n.classList.remove("modal-view"))})}mySlider(),activateSlider(),showModal();var api_url="https://academy.directlinedev.com/api";function getUserFormData(e){switch(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"json"){case"json":var t,r={},n=_createForOfIteratorHelper(e.querySelectorAll("input"));try{for(n.s();!(t=n.n()).done;){var a=t.value;r[a.name]=a.value}}catch(e){n.e(e)}finally{n.f()}return JSON.stringify(r);case"formData":var s=new FormData(e);return console.log(s),s;default:throw new Error("getUserFormData fn: Incorrect data type")}}function sendRequest(e){var t=e.endpoint,r=e.method,n=e.headers,e=e.body,e={method:void 0===r?"GET":r,headers:void 0===n?null:n,body:void 0===e?null:e};return fetch("".concat(api_url).concat(t),e)}function findToken(){var e=localStorage.getItem("token"),t=document.querySelector(".js-btn-signin"),r=document.querySelector(".js-btn-register"),n=document.querySelector(".js-btn-profile");if(!e)return!1;t.classList.add("hidden"),r.classList.add("hidden"),n.classList.remove("hidden")}function validateEmail(e){return/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/.test(e.value)}function validatePass(e){return/^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=\S+$).{8,}$/.test(e.value)}function validateOnlyTxt(e){return/^[а-яА-ЯёЁa-zA-Z]+$/.test(e.value)}function validateMsg(e){return/^[а-яА-ЯёЁa-zA-Z0-9 ]+$/.test(e.value)}function validatePhone(e){return/^((8|\+7)[\- ]?)?(\(?\d{3}\)?[\- ]?)?[\d\- ]{11}$/.test(e.value)}function invalidInput(e){e.classList.remove("is-valid"),e.classList.add("is-invalid")}function validInput(e){e.classList.remove("is-invalid"),e.classList.add("is-valid")}findToken();var formSignin=document.querySelector(".js-signin");formSignin.addEventListener("submit",function(e){var t=document.querySelectorAll(".modal-signin__input.js-input"),r=document.querySelector(".modal-signin__input.js-input-email"),n=document.querySelector(".modal-signin__input.js-input-pass");t.forEach(function(e){""===e.value?e.classList.add("is-invalid"):e.classList.remove("is-invalid")}),validateEmail(r)?validInput(r):(invalidInput(r),e.preventDefault()),validatePass(n)?validInput(n):(invalidInput(n),e.preventDefault())});var formRegister=document.querySelector(".js-register");formRegister.addEventListener("submit",function(e){var t=document.querySelectorAll(".modal-reg__input.js-input"),r=document.querySelector(".modal-reg__input.js-input-email"),n=document.querySelector(".modal-reg__input.js-input-pass"),a=document.querySelector(".modal-reg__input.js-input-passRepeat"),s=document.querySelector(".modal-reg__input.js-input-name"),i=document.querySelector(".modal-reg__input.js-input-surname"),o=document.querySelector(".modal-reg__input.js-input-age"),l=document.querySelector(".modal-reg__input.js-input-location"),d=document.querySelector(".modal-reg__checkbox.js-input-checkbox"),c=document.querySelector(".modal-reg__label-agree"),u=document.querySelector(".msgEmail"),m=document.querySelector(".msgName"),v=document.querySelector(".msgSurname"),p=document.querySelector(".msgPass"),g=document.querySelector(".msgRepPass"),f=document.querySelector(".msgLocation"),y=document.querySelector(".msgAge");t.forEach(function(e){""===e.value?e.classList.add("is-invalid"):e.classList.remove("is-invalid")}),validateEmail(r)?(validInput(r),u.innerHTML="All right",u.classList.remove("error-msg"),u.classList.add("correct-msg")):(e.preventDefault(),invalidInput(r),u.innerHTML='Please enter a valid email address (your entry is not in the format "somebody@example.com")',u.classList.remove("correct-msg"),u.classList.add("error-msg")),validatePass(n)?(validInput(n),p.innerHTML="All right",p.classList.remove("error-msg"),p.classList.add("correct-msg")):(e.preventDefault(),invalidInput(n),p.innerHTML='Length password more 8 symbols (example: "Maks2332")',p.classList.remove("correct-msg"),p.classList.add("error-msg")),a.value!==n.value||""==a.value?(e.preventDefault(),invalidInput(a),g.innerHTML="Passwords don't match",g.classList.remove("correct-msg"),g.classList.add("error-msg")):(validInput(a),g.innerHTML="All right",g.classList.remove("error-msg"),g.classList.add("correct-msg")),validateOnlyTxt(s)?(validInput(s),m.innerHTML="All right",m.classList.remove("error-msg"),m.classList.add("correct-msg")):(e.preventDefault(),invalidInput(s),m.innerHTML="Not correct",m.classList.remove("correct-msg"),m.classList.add("error-msg")),validateOnlyTxt(i)?(validInput(i),v.innerHTML="All right",v.classList.remove("error-msg"),v.classList.add("correct-msg")):(e.preventDefault(),invalidInput(i),v.innerHTML="Not correct",v.classList.remove("correct-msg"),v.classList.add("error-msg")),validateOnlyTxt(l)?(validInput(l),f.innerHTML="All right",f.classList.remove("error-msg"),f.classList.add("correct-msg")):(e.preventDefault(),invalidInput(l),f.innerHTML="Required field",f.classList.remove("correct-msg"),f.classList.add("error-msg")),""==o.value||isNaN(o.value)||100<o.value?(e.preventDefault(),invalidInput(o),y.innerHTML="Required field",y.classList.remove("correct-msg"),y.classList.add("error-msg")):(validInput(o),y.innerHTML="All right",y.classList.remove("error-msg"),y.classList.add("correct-msg")),d.checked?c.style.color="":(c.style.color="#eb3617",e.preventDefault())});var formMessage=document.querySelector(".js-message");formMessage.addEventListener("submit",function(e){var t=document.querySelectorAll(".modal-sendmsg__input.js-input"),r=document.querySelector(".modal-sendmsg__input.js-input-email"),n=document.querySelector(".modal-sendmsg__input.js-input-name"),a=document.querySelector(".modal-sendmsg__input.js-input-phone"),s=document.querySelector(".modal-sendmsg__input.js-input-subject"),i=document.querySelector(".modal-sendmsg__textarea"),o=document.querySelector(".modal-sendmsg__checkbox"),l=document.querySelector(".modal-sendmsg__label-agree");t.forEach(function(e){""===e.value?e.classList.add("is-invalid"):e.classList.remove("is-invalid")}),validateOnlyTxt(n)?validInput(n):(invalidInput(n),e.preventDefault()),validateMsg(s)?validInput(s):(invalidInput(s),e.preventDefault()),validateEmail(r)?validInput(r):(invalidInput(r),e.preventDefault()),validatePhone(a)?validInput(a):(invalidInput(a),e.preventDefault()),validateMsg(i)?i.style.border="2.5px solid #03BC3C":(i.style.border="2.5px solid #eb3617",e.preventDefault()),o.checked?l.style.color="":(l.style.color="#eb3617",e.preventDefault())});var formRegistration=document.forms.registration,api_url_users="https://academy.directlinedev.com/api/users",modal_reg=document.querySelector("#register");function registerUser(e){e.preventDefault(),sendRequest({endpoint:"/users",method:"POST",headers:{"Content-Type":"application/json"},body:getUserFormData(formRegistration)}).then(function(e){if(e.ok)return e.json();throw new Error("Request failed")}).then(function(e){modal_reg.classList.remove("modal-view")}).catch(function(e){return console.error(e)})}formRegistration.addEventListener("submit",function(e){registerUser(e)});var formLogin=document.forms.signin,modal_signin=document.querySelector("#signin");function loginUser(e){e.preventDefault(),sendRequest({endpoint:"/users/login",method:"POST",headers:{"Content-Type":"application/json"},body:getUserFormData(formLogin)}).then(function(e){if(e.ok)return modal_reg.classList.remove("modal-view"),e.json();throw console.log("asdasdasd"),new Error("Login status is ".concat(e.status))}).then(function(e){var t=e.data,e=t.token,t=t.userId;localStorage.setItem("id",t),localStorage.setItem("token",e),location.href="profile.html"}).catch(function(e){return console.error(e)})}formLogin.addEventListener("submit",function(e){loginUser(e)});